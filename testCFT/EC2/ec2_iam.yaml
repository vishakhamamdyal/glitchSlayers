AWSTemplateFormatVersion: '2010-09-09'
Resources:
  AdminRole:
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Action: sts:AssumeRole
          Effect: Allow
          Principal:
            Service: ec2.amazonaws.com
        Version: '2012-10-17'
      Policies:
      - PolicyDocument:
          Statement:
          - Action: '*'
            Effect: Allow
            Resource: '*'
          Version: '2012-10-17'
        PolicyName: FullAccessPolicy
      RoleName: WildcardAdminRole
    Type: AWS::IAM::Role
  VulnerableEC2:
    Properties:
      BlockDeviceMappings:
      - DeviceName: /dev/xvda
        Ebs:
          Encrypted: true
          VolumeSize: 20
      IamInstanceProfile:
        Ref: AdminRole
      ImageId: ami-0c55b159cbfafe1f0
      InstanceType: t2.micro
      KeyName: insecure-key
    Type: AWS::EC2::Instance
